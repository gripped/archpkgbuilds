# Maintainer: George Hu <integral@archlinux.org>
# Contributor: Mark Wagie <mark dot wagie at proton dot me>

pkgname=fvm
pkgver=3.2.1
pkgrel=4
pkgdesc="Flutter Version Management: A simple CLI to manage Flutter SDK versions."
arch=('x86_64')
url="https://${pkgname}.app"
license=('MIT')
depends=('git' 'glibc' 'unzip')
makedepends=('dart')
source=("${pkgname}-${pkgver}.tar.gz::https://github.com/leoafarias/${pkgname}/archive/refs/tags/${pkgver}.tar.gz")
sha256sums=('d4d524a5e1d7c5160b17ee9c3b2dd4482224d2e1c27c8d494fa0290ae818cd41')
options=('!strip' '!debug')

prepare() {
	cd "${pkgname}-${pkgver}/"

	# Disable analytics
	dart --disable-analytics

	# Download dependencies
	dart pub get
}

build() {
	cd "${pkgname}-${pkgver}/"
	dart compile exe -o "bin/${pkgname}" bin/main.dart
}

package() {
	cd "${pkgname}-${pkgver}/"
	install -Dm755 "bin/${pkgname}" -t "${pkgdir}/usr/bin/"
	install -Dm644 LICENSE -t "${pkgdir}/usr/share/licenses/${pkgname}/"
}
