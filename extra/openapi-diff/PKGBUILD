# Maintainer: David Runge <dvzrv@archlinux.org>

pkgname=openapi-diff
pkgver=2.1.3
pkgrel=1
pkgdesc=" Utility for comparing two OpenAPI specifications"
arch=('any')
url="https://github.com/OpenAPITools/openapi-diff"
license=(
  0BSD
  Apache-2.0
)
depends=(
  bash
  java-runtime=8
)
makedepends=(
  maven
  java-environment=8
)
source=(
  $url/archive/$pkgver/$pkgname-$pkgver.tar.gz
  $pkgname.sh
  LICENSE
)
sha512sums=('2cbe9ef4c10d6b37020f29c40e4bb4b919702ff1fe868aecc6dcc0cbf82ce5d6f0aea7ae1776a5b61a63b7e91aef08350b765302ba0cb1cfc693fa43e7b8f24f'
            'e4143cff09abc59958f50a969ed3f010ab39e640cf77081e47e77cf3e2bb785645100572fd18bc508ea441732bc13a5a811332fdbfdbd7f8a0d6865f301f978e'
            'a33658d9271e5c537ccd41bf540b463ad2a5eca4a060c80486ff42a736f0aa042d10436e7177c34d792177cb11285243dee1f31c4df54fb0bfaabbc306406930')
b2sums=('a2a88713468e8fd8bd10f3a20ac49bae56a436a5c13cab4237cbe7f72dac9d1426dc525585a06c5ffa6f35324547aa003593377f7dd3697f03991daca92f778b'
        'a28a194b1b5c731fd3093c22754fc7f6641441ae2acb1ad177b8ee573d8e3787af2b249740ffd1e3472f721e0274d0866c0acf1bf5c85f4a22fe1c2dcf24af7b'
        'a29664104e1ee73ca0aee1d633e9095d92a57c92787f8d8740bdb7211ba3205782ed8677f539bdb8cae3dd75a3694be3132e185fa3fc4b3f401e1f88eb776101')

build() {
  cd $pkgname-$pkgver
  mvn clean install
}

package() {
  cd $pkgname-$pkgver
  install -vDm 644  cli/target/openapi-diff-cli-$pkgver-all.jar "$pkgdir/usr/share/java/$pkgname/$pkgname-cli.jar"
  install -vDm 755 ../$pkgname.sh "$pkgdir/usr/bin/$pkgname"
  ln -svf $pkgname "$pkgdir/usr/bin/$pkgname-cli"
  install -vDm 644 README.md -t "$pkgdir/usr/share/doc/$pkgname/"
  install -vDm 644 ../LICENSE "$pkgdir/usr/share/licenses/$pkgname/0BSD.txt"
}
