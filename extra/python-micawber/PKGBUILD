# Maintainer: David Runge <dvzrv@archlinux.org>

pkgname=python-micawber
_name=${pkgname#python-}
pkgver=0.6.2
pkgrel=1
pkgdesc="A small library for extracting rich content from urls"
arch=(any)
url="https://github.com/coleifer/micawber"
license=(MIT)
depends=(python)
makedepends=(
  python-build
  python-installer
  python-setuptools
  python-wheel
)
checkdepends=(
  python-pytest
  python-beautifulsoup4
  python-django
)
optdepends=(
  'python-beautifulsoup4: for text parser'
  'python-django: django support'
  'python-flask: flask support'
  'python-redis: redis caching support'
)
source=($_name-$pkgver.tar.gz::$url/archive/refs/tags/$pkgver.tar.gz)
sha512sums=('7c9a4d155f8269c83d85ccdf27378eaf59dab3704159f76d0ffeda47af5c0617a9a5dc1dc0d5941adfbf64477c34e3335fa33f1b7fce0bf5fd350937a1a631d1')
b2sums=('db1d61cdd6fed50b6640b6ffd453677886b30db8978c3a5ebc2589614d658c0912fe904b0581deaab87188e958209d5878d06256bd70f3bb07dfaa45862091f5')

build() {
  cd $_name-$pkgver
  python -m build --wheel --no-isolation
}

check() {
  cd $_name-$pkgver
  python runtests.py
}

package() {
  cd $_name-$pkgver
  python -m installer --destdir="$pkgdir" dist/*.whl
  install -vDm 644 LICENSE -t "$pkgdir/usr/share/licenses/$pkgname/"
  install -vDm 644 README.rst -t "$pkgdir/usr/share/doc/$pkgname/"
}
