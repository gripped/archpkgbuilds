# Maintainer: Morten Linderud <foxboron@archlinux.org>
# Contributor: Bart≈Çomiej Piotrowski <bpiotrowski@archlinux.org>

pkgname=toolbox
pkgver=0.2
pkgrel=1
pkgdesc='Unprivileged development environment'
arch=(x86_64)
url='https://github.com/containers/toolbox'
license=(Apache-2.0)
depends=(podman bash flatpak)
makedepends=(go shellcheck go-md2man bash-completion ninja git meson podman fish)
source=("git+$url#tag=$pkgver")
sha512sums=('5afed8038dc370ef9a051c9229f910434ca1c6bf8ef29310efb02bc0563c8c998d1e409ab283a8bc58c22605c5bfa378b9b8398e91f351c8960ca2aec3d0801d')
b2sums=('f607ec3b6765725e9673f7ae9aff96d629fadefc94c8b82f99f134572b1845a7b88644f2b9b614c8b16dbf87051679d058290d7b056fa56988becf37f5a96a74')

build() {
  export GOFLAGS="-buildmode=pie -trimpath -mod=readonly -modcacherw"
  arch-meson toolbox build -D profile_dir=/etc/profile.d
  ninja -C build
}

package() {
  DESTDIR="$pkgdir" ninja -C build install
}
