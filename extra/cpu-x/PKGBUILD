# Maintainer: Peter Jung <ptr1337@archlinux.org>
# Contributor: UnicornDarkness

pkgname=cpu-x
pkgver=5.4.0
pkgrel=1
pkgdesc="A Free software that gathers information on CPU, motherboard and more"
arch=(x86_64)
url="https://thetumultuousunicornofdarkness.github.io/CPU-X"
license=(GPL-3.0-only)
depends=(
  cairomm
  dconf
  gcc-libs
  glib2
  glibc
  glibmm
  gtkmm3
  libcpuid
  libglvnd
  libsigc++
  ncurses
  opencl-icd-loader
  pangomm
  pciutils
  procps-ng
  vulkan-icd-loader
)
makedepends=(
  cmake
  git
  nasm
  ninja
  opencl-headers
  polkit
  vulkan-headers
)
optdepends=('opengl-driver: packaged openGL driver'
            'vulkan-driver: packaged Vulkan driver'
            'opencl-driver: packaged OpenCL driver')
source=("cpu-x::git+https://github.com/TheTumultuousUnicornOfDarkness/CPU-X.git#tag=v${pkgver}")
sha512sums=('c68ac208d1ba6684a07c0d545cd60c8225a5b95234ae8bc98f01a10f8b940e67b28e27b6fbd5f5a37d50433f57977331eadf340af1ade9cd0d69cc090fca75a0')

build() {
	cmake -S "$pkgname" -B build -GNinja -DCMAKE_BUILD_TYPE=None -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_INSTALL_LIBEXECDIR="lib/cpu-x"
	cmake --build build
}

check() {
	ninja -C build test
}

package() {
	DESTDIR="$pkgdir" cmake --install build
}
