# Maintainer: Jakub Klinkovsk√Ω <lahwaacz at archlinux dot org>
# Contributor: Luis Martinez <luis dot martinez at disroot dot org>
# Contributor: Eli Schwartz <eschwartz@archlinux.org>

pkgname=python-hstspreload
pkgver=2025.12.3
pkgrel=2
pkgdesc='Chromium HSTS Preload list as a Python package'
arch=(any)
url='https://github.com/sethmlarson/hstspreload'
license=(BSD-3-Clause)
depends=(python)
makedepends=(
  git
  python-build
  python-installer
  python-setuptools
)
checkdepends=(
  python-pytest
  python-urllib3
)
source=("$pkgname::git+$url#tag=$pkgver")
sha512sums=('88c05517a5081be224b97ccaa460287dc92a00a0d5fc68a0ab2423f8504c4e28fa02468f2cd0cea1ef1f424718092dfeb7bbb91b39cdd7202280318080f39145')
b2sums=('99cac1b54dc5ad7184db62e7744e8440c113ce0b18231ee538a2bad60e186da37cf4660fc7bf3a01f0d3bb89ca40ec6288739e3b0be98043bec3a0fb3e5ebf98')

build() {
  cd "$pkgname"

  python -m build --wheel --no-isolation
}

# This runs around 230k tests, checking to see if the online list matches the current one.
# It can take 5 minutes just to collect the tests. They're not distributed in the PyPI tarball.
#check() {
#  cd "${srcdir}"/${_pkg}-${pkgver}
#
#  python -m pytest
#}

package() {
  cd "$pkgname"

  python -m installer --destdir="$pkgdir" dist/*.whl

  # license
  install -vDm644 -t "$pkgdir/usr/share/licenses/$pkgname" LICENSE
}
