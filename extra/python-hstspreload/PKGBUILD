# Maintainer: Jakub Klinkovsk√Ω <lahwaacz at archlinux dot org>
# Contributor: Luis Martinez <luis dot martinez at disroot dot org>
# Contributor: Eli Schwartz <eschwartz@archlinux.org>

pkgname=python-hstspreload
pkgver=2026.2.1
pkgrel=1
pkgdesc='Chromium HSTS Preload list as a Python package'
arch=(any)
url='https://github.com/sethmlarson/hstspreload'
license=(BSD-3-Clause)
depends=(python)
makedepends=(
  git
  python-build
  python-installer
  python-setuptools
)
checkdepends=(
  python-pytest
  python-urllib3
)
source=("$pkgname::git+$url#tag=$pkgver")
sha512sums=('6af19c3be5f02c29192e97ee62a99123c6cda753fad4ad399817f99a46c507bbd93bd08ab5529ecec949f1c4ea2a2b78d903a5dd72f6317fed821ca381307986')
b2sums=('ebd52f60b80b3b2accdccaaf0e33ca3cc2de9db03519995080742948144f09af6b37b2cc2807e3917aef2fd9d187032a07b2a86cd3e71725f6cc7e85bc877958')

build() {
  cd "$pkgname"

  python -m build --wheel --no-isolation
}

# This runs around 230k tests, checking to see if the online list matches the current one.
# It can take 5 minutes just to collect the tests. They're not distributed in the PyPI tarball.
#check() {
#  cd "${srcdir}"/${_pkg}-${pkgver}
#
#  python -m pytest
#}

package() {
  cd "$pkgname"

  python -m installer --destdir="$pkgdir" dist/*.whl

  # license
  install -vDm644 -t "$pkgdir/usr/share/licenses/$pkgname" LICENSE
}
