# Maintainer: David Runge <dvzrv@archlinux.org>

pkgname=mkinitcpio-systemd-tool
pkgver=39
pkgrel=1
pkgdesc="Provisioning tool for systemd in initramfs (systemd-tool)"
arch=(any)
url="https://github.com/random-archer/mkinitcpio-systemd-tool"
license=(Apache-2.0)
depends=(
  bash
  mkinitcpio
  systemd
)
optdepends=(
  'busybox: for initrd-tinysshd.service'
  'cryptsetup: for initrd-cryptsetup.service'
  'dropbear: for initrd-dropbear.service'
  'mc: for initrd-debug-progs.service'
  'nftables: for initrd-nftables.service'
  'tinyssh: for initrd-tinysshd.service'
)
conflicts=(
  mkinitcpio-dropbear
  mkinitcpio-tinyssh
)
backup=(
  etc/$pkgname/config/crypttab
  etc/$pkgname/config/fstab
  etc/$pkgname/config/initrd-nftables.conf
  etc/$pkgname/config/initrd-util-usb-hcd.conf
  etc/$pkgname/config/ntp.conf
  etc/$pkgname/$pkgname.conf
  etc/$pkgname/network/initrd-network.network
)
source=(
  $url/archive/v$pkgver/$pkgname-v$pkgver.tar.gz
)
install=$pkgname.install
sha512sums=('48e454f2ac2029569512b86a4ca6355c6b647e3197ba1c5cb984de3260657d1d11b9bde06c86f40a06c96aa1aeee6a283bbf972de873917b7f1ebd95ea977dff')
b2sums=('8eb4ba7dec91236f572fbdd431d8f2db501731a168587d34758a29d6e0e5c6bbb36f5b7e72c224a895d02f8d36842ce907e732e39341cb82041b092e6017fba2')

package() {
  make DESTDIR="$pkgdir/" PREFIX=/usr install -C $pkgname-$pkgver
}
