# Maintainer: David Runge <dvzrv@archlinux.org>

pkgname=mkinitcpio-systemd-tool
pkgver=38
pkgrel=1
pkgdesc="Provisioning tool for systemd in initramfs (systemd-tool)"
arch=(any)
url="https://github.com/random-archer/mkinitcpio-systemd-tool"
license=(Apache-2.0)
depends=(
  bash
  mkinitcpio
  systemd
)
optdepends=(
  'busybox: for initrd-tinysshd.service'
  'cryptsetup: for initrd-cryptsetup.service'
  'dropbear: for initrd-dropbear.service'
  'mc: for initrd-debug-progs.service'
  'nftables: for initrd-nftables.service'
  'tinyssh: for initrd-tinysshd.service'
)
conflicts=(
  mkinitcpio-dropbear
  mkinitcpio-tinyssh
)
backup=(
  etc/$pkgname/config/crypttab
  etc/$pkgname/config/fstab
  etc/$pkgname/config/initrd-nftables.conf
  etc/$pkgname/config/initrd-util-usb-hcd.conf
  etc/$pkgname/config/ntp.conf
  etc/$pkgname/$pkgname.conf
  etc/$pkgname/network/initrd-network.network
)
source=($url/archive/v$pkgver/$pkgname-v$pkgver.tar.gz)
install=$pkgname.install
sha512sums=('2cddc1a56217490b203b0412ea85f2aaf304514ec73ed2bf9aff50ab97248859e18e581a86d519599762189f36f634634d2250ece753d474056ca8079624d1dc')
b2sums=('d413543030f60f64c38e2a7702cfc369e03cbf2ef47a3c23c982526762a90b3d9df2fc96e956039522cc389674e6809cdc8b416de00292fe4993d831af985adf')

package() {
  make DESTDIR="$pkgdir/" PREFIX=/usr install -C $pkgname-$pkgver
}
