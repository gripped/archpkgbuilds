# Maintainer:
# Contributor: Blair Bonnett <blair.bonnett@gmail.com>

_pyname=scikit_build_core
pkgname=python-scikit-build-core
pkgdesc='Next generation Python CMake adaptor and Python API for plugins'
url='https://scikit-build-core.readthedocs.io/'
pkgver=0.8.2
pkgrel=2
arch=('any')
license=('Apache-2.0')

depends=(
  'cmake'
  'ninja'
  'python-cattrs'
  'python-packaging'
  'python-pathspec'
  'python-pyproject-metadata'
  'python-rich'
)
makedepends=('python-build' 'python-hatchling' 'python-hatch-vcs' 'python-installer')
checkdepends=(
  'cython'
  'gcc-fortran'
  'git'
  'pybind11'
  'python-hatch-fancy-pypi-readme'
  'python-numpy'
  'python-pip'
  'python-pytest'
# 'python-pytest-subprocess'
  'python-setuptools-scm'
  'python-virtualenv'
)

source=(
  "https://files.pythonhosted.org/packages/source/${_pyname::1}/$_pyname/$_pyname-$pkgver.tar.gz"
)
sha256sums=('50ec24b9568c9aa6e27233deeb2978932bc79856212b30575cbfa4049655c436')

build() {
  cd "$_pyname-$pkgver"
  python -m build --wheel --no-isolation
}

#check() {
#  cd "$_pyname-$pkgver"
#  python -m venv --system-site-packages test-env
#  test-env/bin/python -m installer dist/*.whl
#  test-env/bin/python -m pytest -v
#}

package() {
  cd "$_pyname-$pkgver"
  python -m installer --destdir="$pkgdir" dist/*.whl
}
