# Maintainer: Levente Polyak <anthraxx[at]archlinux[dot]org>
# Maintainer: T.J. Townsend <blakkheim@archlinux.org>
# Contributor: Eli Schwartz <eschwartz@archlinux.org>

pkgname=exploitdb
_pkgver=2024-02-06
pkgver=${_pkgver//-/}
pkgrel=1
pkgdesc="Offensive Securityâ€™s Exploit Database Archive"
arch=('any')
url="https://www.exploit-db.com/"
license=('GPL-2.0-or-later')
optdepends=('libxml2: to check nmap XML results'
            'xclip: copy paths to the clipboard')
backup=('etc/searchsploit_rc')
options=('!strip')
source=("https://gitlab.com/exploit-database/exploitdb/-/archive/$_pkgver/exploitdb-$_pkgver.tar.bz2"
        "rcfile.diff")
sha512sums=('e1bd02ff8bcc232029cc927b972bf0dbf99c61aa1f75e17debd3de9c0556673a2c11f6f4e29eb30fb4911d983443b48ef0f61b6760371955edb6609ccfb6239c'
            'e170da5b974975c6c23c5b09e8c1825bbb17446fb506f2d00f92f86f94394acf18a53458bd90969de38da642fc1f7abb08ba940969108002dab17415b88211d6')
b2sums=('d5e18a49930e9ad2f9c54000b09bd8d7fd014d1d43d129c4f2fa1002f0c8966c09808add9e2f28b91ca4c581e22a47f2a54adf046604a708d839a79579f5ec3f'
        'f033a50db6358297580363d62bbd9d4a6003b5476ba361650133841138af76b990ed49e2e34d487cf4167ebeb3cd6b8f9230e5e700a5d96f7f06cbc5b42c4076')

prepare() {
    cd ${pkgname}-${_pkgver}

    patch -p1 -i ../rcfile.diff
}

package() {
    cd ${pkgname}-${_pkgver}

    install -Dm755 searchsploit "${pkgdir}"/usr/bin/searchsploit
    install -Dm644 .searchsploit_rc "${pkgdir}"/etc/searchsploit_rc
    mkdir -p "${pkgdir}"/usr/share/${pkgname}
    cp -a exploits/ shellcodes/ files_*.csv "${pkgdir}"/usr/share/${pkgname}
}

# vim: ts=4 sw=4 et:
