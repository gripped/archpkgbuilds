# Maintainer: Jakub Klinkovsk√Ω <lahwaacz at archlinux dot org>

pkgname=cutensor
pkgver=2.5.0.2
_cudaver=13
pkgrel=1
pkgdesc="High-performance CUDA library for tensor primitives"
arch=(x86_64)
url="https://docs.nvidia.com/cuda/cutensor/latest/index.html"
license=(LicenseRef-NVIDIA-cuTENSOR)
depends=(
  "cuda>=$_cudaver"
  gcc-libs
  glibc
)
optdepends=(
  'nccl: for the multi-process extension (cuTENSORMp)'
)
options=(!strip)
source=(https://developer.download.nvidia.com/compute/$pkgname/redist/lib$pkgname/linux-x86_64/lib$pkgname-linux-x86_64-${pkgver}_cuda$_cudaver-archive.tar.xz)
b2sums=('7299a9b3ce2a1e42edf20a986c88ea81324a9b841f1eb02d10edb03e9ca9f395c469ab89aec9d85bc5c06565aaf370a6f3756bbdbce97f87667c2f34b8f5dbed')

package() {
  cd lib$pkgname-linux-x86_64-${pkgver}_cuda${_cudaver}-archive

  install -vdm 755 "$pkgdir"/usr/
  cp -r lib include "$pkgdir"/usr/

  # remove static libs
  rm "$pkgdir"/usr/lib/*.a

  install -vDm 644 LICENSE -t "$pkgdir"/usr/share/licenses/$pkgname/
}
