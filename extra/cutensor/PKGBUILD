# Maintainer: Jakub Klinkovsk√Ω <lahwaacz at archlinux dot org>

pkgname=cutensor
pkgver=2.4.1.4
_cudaver=13
pkgrel=1
pkgdesc="High-performance CUDA library for tensor primitives"
arch=(x86_64)
url="https://docs.nvidia.com/cuda/cutensor/latest/index.html"
license=(LicenseRef-NVIDIA-cuTENSOR)
depends=(
  "cuda>=$_cudaver"
  gcc-libs
  glibc
)
optdepends=(
  'nccl: for the multi-process extension (cuTENSORMp)'
)
options=(!strip)
source=(https://developer.download.nvidia.com/compute/$pkgname/redist/lib$pkgname/linux-x86_64/lib$pkgname-linux-x86_64-${pkgver}_cuda$_cudaver-archive.tar.xz)
b2sums=('fafbebb43299aa7d8441e6f81a87e3eebbf1e7f146f465a3b12c9107d6f3fc1e3cd22ab861eb4b4266a62d5976ab57dc7dc54fc7eb20e2ea1975e9573f491d1a')

package() {
  cd lib$pkgname-linux-x86_64-${pkgver}_cuda${_cudaver}-archive

  install -vdm 755 "$pkgdir"/usr/
  cp -r lib include "$pkgdir"/usr/

  # remove static libs
  rm "$pkgdir"/usr/lib/*.a

  install -vDm 644 LICENSE -t "$pkgdir"/usr/share/licenses/$pkgname/
}
